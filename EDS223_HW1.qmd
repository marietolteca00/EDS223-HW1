---
title: "Environmental Injustice in Ventura County"
author: "Marie Tolteca"
date: last-modified
format: pdf
editor: visual
---
# Importing Library and Data
```{r, message=FALSE, output=FALSE}
#| warning: false
#| message: false

# Loading in packages
library(tidyverse)
library(sf)
library(here)
library(dplyr)
library(tmap)

# read in geodatabase of EJScreen data at the Census Block Group level and cities.
ejscreen <- sf::st_read(here::here("data", "ejscreen","EJSCREEN_2023_BG_StatePct_with_AS_CNMI_GU_VI.gdb")) 
cities <- sf::st_read(here::here("data", "City_Boundary","City_Boundary.shp")) 

```

# Data Cleaning
```{r, output=FALSE}
#| message: false
#| warning: false
# filter to a state you are interested in
california <- ejscreen %>%
  dplyr::filter(ST_ABBREV == "CA") 

# filter to a county you are interested in
ventura <- ejscreen %>%
  dplyr::filter(CNTY_NAME %in% c("Ventura County"))

# find the average values for all variables within counties
california_counties <- aggregate(california, by = list(california$CNTY_NAME), FUN = mean)
# tried 'drop_na()' but mapping didn't work ' 
```

# Visualizations
### Map 1: Low-income Percentile

```{r}
#| message: false
#| warning: false


# Name of map- using ventura data
ventura_low <- tm_shape(ventura, bbox = c(-119.55, 33.95, -118.3, 34.55)) +
  # Creating polygon for percentile low impact
  tm_polygons(
    "P_LOWINCPCT",
    title = "Percent Ranges of Low Income",
    palette = "YlOrRd",
    style = "pretty"
  ) +
# Adding a mini globe
  #tm_minimap(position = c("right", "bottom")) +
  tm_layout(
    # main title
    main.title = "Ventura County Low Income Population",
    # title size
    main.title.size = 1.2,
    #background coffee
    bg.color = "lightblue",
    #changes size of map
    asp = 1.2,
    # font
    legend.title.fontface = 2,
    #size of text 
    legend.text.size = 0.8,
    # border lines on map
    frame.double.line = TRUE
  ) +
  tm_compass()+
  tm_scalebar()

# Print map
print(ventura_low)

# Save map
tmap_save(ventura_low, here("figs", "ventura_low.jpeg"))

```


```{r}
#| message: false
#| warning: false
#| echo: false


# # Name of map- using ventura data
# ventura_low <- tm_shape(ventura, bbox = c(-119.55, 33.95, -118.3, 34.55)) +
#   # Using low income varibale
#   tm_polygons("P_LOWINCPCT",
#               # adding title
#               title = "Percent Ranges of Low Income",
#               # color palette that shows percentile low income
#               palette = "YlOrRd",
#               # style for legend numbers
#               style = "pretty") +
#   
#   tm_layout(main.title = "Ventura County Low Income Population (Pop.)",
#             # background color on map
#              bg.color = "lightblue",
#             # size of map (portrait, landscape, etc.)
#             asp = 1.2,
#             # Bold letters on legend
#             legend.title.fontface = 2,
#             #Changing font type
#             #text.fontfamily = "Times New Roman",
#             # text size
#             legend.text.size = 0.8,
#             frame.double_line = TRUE)+
  #tm_shape(cities) +
  # Looks better when in interactive mode
  #tm_text("city_name",
          # making letters bold
          #fontface = "bold",
          # size of letters
          #size = 0.6)+
          # background label 
          #bgcol = "white") + # looks better with interactive map
  #changing the border color of the cities
  #tm_borders(col = "green",
             # size of line/border
             #size=0.5)+
# adding minimap
  # tm_minimap()+
  #   tm_layout((position = c("right", "bottom"))+
  # adding compass
  # tm_compass()+
  # adding scale bar
  # tm_scalebar()

# Printing map
#print(ventura_low)

# Saving Map to figs folder
#tmap_save(ventura_low, here("figs", "ventura_low.jpeg"))
```
#### Interpretation:
Low-Income: For my interpretation of the percentile for low income, it is evident that in the Oxnard Plain areas (Oxnard, San Buenaventura, and Port Hueneme) and Santa Paula, have a bigger Percentile of Low Income population. This could be because of the type of jobs around these areas, agriculture fields, and construction. Majority of this area consist of the 101- Freeway that means these lower income communities get hit with a big part of particulate matter. Personally, I grew up around these areas, in particular North Oxnard, where it has undergone gentrification and continues to go.

# Map 2: PM2.5 levels

```{r}
#| message: false
#| warning: false

ventura_pm25 <- # Using particulate matter varibale
  tm_shape(ventura,  bbox = c(-119.55, 33.95, -118.3, 34.55))+
  # variable particulate matter
  tm_polygons("PM25",
              title = "Particulate Matter 2.5 Âµg/mÂ³",
              #Color of map for pm2.5
              palette = "red",
              #legend numbers
              style = "pretty") +
  
  tm_layout(main.title = "Particulate Matter 2.5 in Ventura County",
            # background color on map
             bg.color = "lightgrey",
            # size of map (portrait, landscape, etc.)
            asp = 1,
            # Bold letters on legend
            legend.title.fontface = 2,
            #Changing font type
            #text.fontfamily = "Times New Roman",
            # text size
            legend.text.size = 1,
            #frame on map
            frame.double_line = TRUE)+
  #tm_minimap()+
  tm_compass()+
  tm_scalebar()
  
#printing map
ventura_pm25

#saving map
tmap_save(ventura_pm25, here("figs", "ventura_pm25.jpeg"))

```
#### Interpretation:
Particulate Matter 2.5: With the increase of infrastructure I assumed the increase of particulate matter would come into play. In addition to the increase of particulate matter 2.5 Ventura County has been recently affect with a rise in wildfires. Wildfires have increased within the last few years mostly in the mountains where dry areas are common, as well as dry river beds with invasive species. In Ventura County the low income population seems to be exposed to more air pollution, showcasing an environmental injustice to certain residents.

# Comparing Percentile of Low Income and Particulate Matter 2.5 in Ventura County
```{r}
#| message: false
#| warning: false
#Both Maps Side-by-side
tmap_arrange(ventura_low, ventura_pm25)
```

Overall, using this the `tmap` package, I focused in Ventura County to look at the Low Income population and Particulate Matter 2.5. I was interested to look at the low income population since some areas are being improved more than others, particularly the area in North Oxnard where you can see a dark shade of red. I grew up un this area and lot of gentrification has occurred throughout my lifetime. Being able to document and visually see the population of low income come being affected by new construction is saddening. With the two maps we are able to see that the low income population is affected by environmental injustice.

## For Fun - The State of California Low-Income Population and Air toxics of Cancer Risk in California
# PLEASE DO NOT MARK OFF POINTSðŸ™

-   Interesting how most of the central valley and surrounding areas have a higher percent of air toxic cancer risk than anywhere else in the state of California. I have a hypothesis of why that might be, the central valley is known to have lots of agriculture fields. It is one of the highest producers throughout California, the pesticides that the agriculture needs might have an affect towards these communities.

```{r}
#| message: false
#| warning: false
# Printing only the state of California
CA_Low_Income <- tm_shape(california_counties) +
  # Showcasing Low - income across California
  tm_polygons("P_LOWINCPCT", # Defines how to plot the object
              title = "Percent of Low - Income - Population",
              palette = "red",
              style = "quantile") +
  tm_symbols(size = "CANCER",
             shape = 2,
             size.legend = tm_legend(orientation = "portrait",
                                     title = "Air toxics Cancer Risk (per County)"),
             col = "deepskyblue2")+
  tm_layout(frame.double_line = TRUE,
            bg.color = "lightblue") +
  tm_shape(ventura) +
  tm_lines()+
  tm_scalebar(position = c("left", "bottom"))+
  tm_compass(position = c("right", "top")) +
  tm_minimap(position = c("right","top"))

CA_Low_Income

tmap_save(CA_Low_Income, here("figs", "CA_lowincome.jpeg"))

```
